// ✅ Safe Replit Prompt: Fix FAQ schema block in index.html
const fs = require("fs");

const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is ConvertWiz?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "ConvertWiz is a free online platform to convert files, currencies, land units, and more."
      }
    },
    {
      "@type": "Question",
      "name": "Is ConvertWiz free to use?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, all tools are free. Premium users can enjoy ad-free experience and bonus tools."
      }
    },
    {
      "@type": "Question",
      "name": "Do I need to install ConvertWiz?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "No installation needed. Just visit convertwiz.in and start using it."
      }
    },
    {
      "@type": "Question",
      "name": "Can I use ConvertWiz on mobile?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, the website is fully responsive and mobile-friendly."
      }
    },
    {
      "@type": "Question",
      "name": "What types of tools are available?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "You can convert JPG to PNG, currency, land units, compress files, and more."
      }
    }
  ]
};

try {
  let html = fs.readFileSync("index.html", "utf8");

  // Remove any existing FAQPage structured data blocks
  html = html.replace(
    /<script type="application\/ld\+json">[\s\S]*?"@type":\s*"FAQPage"[\s\S]*?<\/script>/g,
    ""
  );

  // Safe JSON injection just before </head>
  const schemaScript = `<script type="application/ld+json">\n${JSON.stringify(faqSchema, null, 2)}\n</script>\n</head>`;
  if (html.includes("</head>")) {
    html = html.replace("</head>", schemaScript);
    fs.writeFileSync("index.html", html, "utf8");
    console.log("✅ FAQ schema injected safely and successfully!");
  } else {
    console.error("❌ </head> tag not found. Injection skipped to avoid breaking layout.");
  }
} catch (err) {
  console.error("❌ Failed to update schema:", err.message);
}
